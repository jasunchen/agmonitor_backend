from optimization import *
from parse import *
from sklearn.metrics import r2_score

#initial time, base load, solar load, powerwall, grid usage, battery charge
def findRange(arr): 
    continuous = False
    ranges = []
    for index, i in enumerate(arr):
        if i == 1:
            if continuous == False:
                continuous = True 
                ranges.append([index, index+1])
        elif len(ranges) != 0 and continuous == True:
            continuous = False
            ranges[-1][-1] = index
    return ranges

def convertIndexToTime(index): #0-96, 0 being 00:00, 96 being 24:00
	if (index == 96):
		return "11:59 PM"

	hours = index // 4
	minutes = (index % 4)*15
	if minutes == 0:
		minutes = "00"

	time = "AM"
	if hours >= 12:
		hours -= 12
		time = "PM"

	if hours == 0:
		hours = 12

	return "{}:{} {}".format(hours, minutes, time)


def convertRangeToTimes(arr):
	length = len(arr)
	output = ""
	for index, ele in enumerate(arr):
		if (ele[0] == ele[1]):
			output += convertIndexToTime(ele[0])
		else:
			output += convertIndexToTime(ele[0]) + " to " + convertIndexToTime(ele[1])

		if (index == length - 2):
			output += ", and "
		else: 
			output += ", "

	return output[:-2]

def compareTimes():
    pass

#schedule ["", isOn, timeofday]
#inputs: baseload to test on, flexible load to schedule, schedule of flexible load, initial battery state, solar generation, number of dates
#outputs: utility usage, solar integration 
def checkTime(batterystate, batterySize, baseLoad, solar, shouldCharge, flexibleLoad, day, timeOfDay):
    entire_home_usage = sum(baseLoad) + sum(flexibleLoad)
    entire_solar_gen = sum(solar)

    if shouldCharge:
        for ind, ele in enumerate(flexibleLoad):
            baseLoad[day*96 + timeOfDay + ind] += ele

    energyFlow = computeEnergyFlow(solar, baseLoad)
    costGrid, costRenewableIntegration, excessSolar, excessBattery, utility, temp_battery= computePredictedBatteryChargeAndTotalCost(batterystate, energyFlow, 20, batterySize)
    solarToGrid = sum([item*1000 for item in utility if item >= 0])
    gridUsage = sum([item*-1000 for item in utility if item <= 0])

    return  (gridUsage/entire_home_usage, solarToGrid/entire_solar_gen, baseLoad, temp_battery[-1])





if __name__ == "__main__":
    fileNames = ["Tesladata9-23", "Tesla data 9-24", "Tesla data 9-25", "Tesla data 9-26", "Tesla data 9-27","Tesla data 9-28", "Tesla data 9-29", "Tesla data 9-30", 'Tesla data 10-1', 'Tesla data 10-2', 'Tesla data 10-3', 'Tesla data 10-4', 'Tesla data 10-5', 'Tesla data 10-6', 'Tesla data 10-7', 'Tesla data 10-8', 'Tesla data 10-9', 'Tesla data 10-10', 'Tesla data 10-11', 'Tesla data 10-12', 'Tesla data 10-13', 'Tesla data 10-14', 'Tesla data 10-15', 'Tesla data 10-16', 'Tesla data 10-17', 'Tesla data 10-18', 'Tesla data 10-19', 'Tesla data 10-20', 'Tesla data 10-21', 'Tesla data 10-22', 'Tesla data 10-23', 'Tesla data 10-24']
    dayNames = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"]

    #32 days
        
    pred_solar = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 153, 299, 419, 509, 587, 661, 730, 795, 846, 894, 938, 980, 1022, 1051, 1077, 1089, 1101, 1116, 1125, 1119, 1119, 1109, 1080, 1049, 1023, 986, 944, 899, 845, 792, 731, 662, 584, 503, 417, 326, 231, 145, 72, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 45, 157, 283, 420, 507, 593, 671, 742, 799, 855, 871, 928, 958, 1013, 967, 1024, 1029, 1092, 1041, 1074, 1085, 1113, 1101, 1080, 1068, 1020, 1014, 864, 761, 759, 711, 734, 679, 576, 439, 414, 313, 219, 130, 46, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 48, 163, 285, 432, 510, 591, 666, 732, 793, 848, 897, 939, 979, 1014, 1039, 1064, 1089, 1104, 1113, 1121, 1123, 1114, 1095, 1071, 1043, 1013, 982, 943, 893, 843, 791, 727, 660, 585, 503, 418, 328, 236, 152, 80, 25, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 33, 167, 310, 435, 512, 591, 664, 730, 791, 848, 902, 948, 983, 1015, 1038, 1053, 1070, 1086, 1101, 1105, 1103, 1107, 1105, 1086, 1061, 1031, 990, 951, 908, 853, 790, 726, 657, 583, 507, 422, 332, 240, 154, 80, 25, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 177, 314, 426, 513, 591, 660, 728, 790, 838, 886, 933, 975, 1010, 1044, 1087, 1105, 1124, 1121, 1108, 1110, 1107, 1097, 1064, 1032, 1010, 977, 941, 896, 851, 788, 725, 656, 583, 503, 422, 335, 243, 158, 84, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 57, 185, 312, 442, 523, 602, 674, 738, 798, 852, 903, 951, 973, 1023, 1061, 1081, 1099, 1107, 1115, 1116, 1119, 1114, 1100, 1077, 1050, 1021, 987, 943, 898, 848, 789, 724, 656, 585, 508, 427, 341, 249, 169, 92, 34, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 49, 171, 303, 447, 521, 599, 671, 736, 794, 848, 898, 943, 984, 1018, 1044, 1073, 1098, 1115, 1122, 1119, 1115, 1106, 1089, 1071, 1052, 1026, 987, 944, 903, 856, 799, 736, 669, 596, 517, 433, 344, 253, 166, 91, 33, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 66, 204, 320, 434, 534, 592, 692, 720, 776, 865, 890, 907, 947, 984, 1057, 1044, 1114, 1149, 1141, 1136, 1090, 1030, 1038, 1049, 981, 934, 930, 980, 882, 818, 723, 645, 592, 532, 503, 472, 381, 252, 162, 117, 55, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

    historical_baseload_avg = [202.81, 194.58, 201.93, 191.39, 182.69, 173.9, 152.74, 148.41, 156.21, 152.03, 145.35, 131.46, 145.11, 131.88, 113.24, 126.82, 123.58, 117.17, 105.16, 117.01, 124.4, 124.16, 136.53, 153.96, 195.83, 188.04, 206.4, 185.39, 157.31, 162.97, 167.69, 157.64, 154.85, 168.95, 180.86, 184.54, 188.6, 211.03, 239.68, 235.96, 240.09, 240.21, 255.46, 256.34, 271.9, 271.71, 284.37, 276.12, 274.44, 280.25, 273.16, 255.94, 259.27, 263.37, 258.82, 253.67, 237.28, 245.57, 238.39, 230.99, 213.81, 210.52, 219.89, 212.48, 199.15, 195.35, 218.14, 209.27, 190.1, 160.07, 153.15, 131.11, 114.27, 101.31, 101.25, 113.19, 118.95, 123.82, 125.34, 123.33, 125.79, 133.73, 128.9, 127.8, 129.78, 120.72, 125.98, 138.6, 139.75, 122.82, 124.05, 121.42, 195.17, 198.38, 219.35, 219.91]
    filtered_base = [183.34, 166.67, 141.67, 183.34, 200.0, 200.0, 383.33, 250.0, 166.66, 100.0, 125.0, 183.33, 125.0, 116.67, 150.0, 233.33, 208.33, 225.0, 200.0, 225.0, 150.0, 141.67, 216.67, 150.0, 83.33, 116.66, 141.67, 125.0, 116.66, 133.33, 200.0, 233.33, 225.0, 275.0, 191.66, 150.0, 191.67, 250.0, 200.0, 216.66, 241.67, 300.0, 325.0, 216.67, 308.33, 241.67, 258.33, 291.67, 225.0, 258.34, 291.67, 350.0, 275.0, 383.33, 383.33, 333.33, 383.33, 441.66, 250.0, 183.34, 541.67, 425.0, 375.0, 500.0, 441.67, 308.33, 308.34, 175.0, 216.66, 125.0, 133.33, 116.67, 125.0, 150.0, 125.0, 200.0, 216.67, 225.0, 250.0, 316.67, 275.0, 258.33, 333.33, 258.33, 316.67, 366.67, 375.0, 400.0, 316.67, 416.66, 350.0, 275.0, 258.33, 350.0, 241.67, 233.34, 275.0, 233.33, 291.67, 300.0, 283.34, 241.67, 300.0, 333.34, 225.0, 216.66, 200.0, 133.33, 141.67, 108.33, 116.67, 150.0, 100.0, 100.0, 191.66, 116.66, 108.34, 141.67, 133.33, 216.66, 158.34, 166.66, 150.0, 133.34, 158.33, 250.0, 183.34, 283.33, 250.0, 241.67, 158.33, 208.34, 258.34, 225.0, 375.0, 275.0, 308.33, 275.0, 266.67, 233.34, 258.34, 241.67, 450.0, 237.3844444444444, 237.3844444444444, 237.3844444444444, 237.3844444444444, 237.3844444444444, 237.3844444444444, 237.3844444444444, 237.3844444444444, 237.3844444444444, 237.3844444444444, 191.67, 258.34, 308.33, 183.34, 191.66, 208.33, 266.67, 233.34, 158.33, 166.67, 216.66, 150.0, 133.34, 216.67, 841.67, 375.0, 458.33, 575.0, 350.0, 191.67, 225.0, 241.67, 150.0, 200.0, 183.33, 150.0, 150.0, 233.34, 291.67, 325.0, 300.0, 291.67, 266.66, 266.66, 200.0, 241.66, 216.66, 150.0, 116.67, 275.0, 233.33, 291.67, 300.0, 283.34, 241.67, 300.0, 333.34, 225.0, 216.66, 200.0, 133.33, 141.67, 108.33, 116.67, 150.0, 100.0, 100.0, 191.66, 116.66, 108.34, 141.67, 133.33, 216.66, 158.34, 166.66, 150.0, 133.34, 158.33, 250.0, 183.34, 283.33, 250.0, 241.67, 158.33, 208.34, 258.34, 225.0, 375.0, 275.0, 308.33, 275.0, 266.67, 233.34, 258.34, 241.67, 450.0, 235.82881018518506, 235.82881018518506, 235.82881018518506, 235.82881018518503, 235.82881018518503, 235.82881018518503, 235.828810185185, 235.828810185185, 235.828810185185, 235.82881018518498, 191.67, 258.34, 308.33, 183.34, 191.66, 208.33, 266.67, 233.34, 158.33, 166.67, 216.66, 150.0, 133.34, 216.67, 841.67, 375.0, 458.33, 575.0, 350.0, 191.67, 225.0, 241.67, 150.0, 200.0, 183.33, 150.0, 150.0, 233.34, 291.67, 325.0, 300.0, 291.67, 266.66, 266.66, 200.0, 241.66, 216.66, 150.0, 116.67, 216.67, 150.0, 125.0, 166.67, 225.0, 158.33, 525.0, 408.33, 200.0, 125.0, 125.0, 91.67, 141.67, 141.67, 108.33, 141.67, 225.0, 216.67, 191.66, 166.67, 200.0, 175.0, 158.33, 125.0, 108.34, 125.0, 158.34, 175.0, 141.66, 216.67, 166.67, 175.0, 266.66, 250.0, 416.67, 233.1498844021488, 233.1498844021488, 233.14988440214884, 233.14988440214884, 233.14988440214884, 233.14988440214887, 233.14988440214887, 233.1498844021489, 233.1498844021489, 233.1498844021489, 233.14988440214893, 233.14988440214893, 233.14988440214896, 233.14988440214896, 233.14988440214896, 233.14988440214898, 233.14988440214898, 233.14988440214898, 233.149884402149, 233.149884402149, 233.149884402149, 233.14988440214904, 233.14988440214904, 233.14988440214907, 233.14988440214907, 391.66, 250.0, 208.33, 208.34, 241.66, 241.67, 208.33, 150.0, 200.0, 183.33, 125.0, 133.33, 325.0, 108.33, 125.0, 133.33, 141.67, 216.67, 175.0, 191.67, 191.67, 150.0, 191.67, 266.66, 208.33, 191.66, 225.0, 208.33, 175.0, 241.67, 183.34, 166.66, 141.67, 116.66, 116.67, 125.0, 100.0, 141.67, 133.33, 125.0, 108.34, 133.33, 141.67, 150.0, 100.0, 108.33, 141.66, 116.66, 125.0, 141.66, 133.34, 91.67, 108.34, 100.0, 141.67, 125.0, 83.33, 100.0, 333.33, 200.0, 175.0, 183.34, 208.33, 200.0, 166.66, 141.66, 116.67, 158.33, 166.67, 141.67, 150.0, 175.0, 133.33, 141.67, 291.66, 158.34, 166.66, 191.67, 183.34, 416.67, 250.0, 158.33, 166.66, 225.0, 158.34, 133.33, 316.66, 300.0, 200.0, 200.0, 225.0, 225.0, 191.67, 233.33, 166.67, 158.33, 183.34, 175.0, 166.67, 158.33, 141.67, 125.0, 183.34, 200.0, 183.33, 283.33, 358.33, 241.66, 275.0, 341.67, 333.33, 308.33, 425.0, 375.0, 400.0, 300.0, 216.67, 225.0, 391.66, 550.0, 408.33, 275.0, 258.33, 391.67, 516.67, 333.34, 258.33, 200.0, 141.67, 208.33, 325.0, 358.34, 225.785051260603, 225.785051260603, 225.785051260603, 225.785051260603, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 225.78505126060298, 166.67, 200.0, 200.0, 166.67, 141.66, 75.0, 108.34, 133.34, 125.0, 116.66, 183.34, 316.67, 150.0, 166.67, 291.66, 291.66, 200.0, 141.67, 175.0, 200.0, 150.0, 100.0, 133.33, 216.66, 116.66, 116.67, 216.67, 208.33, 158.33, 183.34, 200.0, 266.67, 191.66, 225.0, 416.66, 325.0, 325.0, 283.33, 291.67, 341.66, 266.66, 283.33, 258.33, 266.66, 333.33, 316.67, 350.0, 225.0, 300.0, 283.34, 341.67, 141.67, 241.67, 166.67, 133.34, 191.66, 158.33, 158.33, 191.67, 250.0, 208.33, 250.0, 266.67, 216.67, 191.67, 266.66, 308.33, 233.33, 208.33, 483.34, 241.67, 191.67, 416.67, 200.0, 250.0, 233.34, 250.0, 250.0, 275.0, 333.33, 216.66, 191.67, 366.66, 283.33, 200.0, 216.67, 366.67, 191.67, 91.66, 116.66, 108.33, 125.0, 150.0, 91.67, 91.67, 133.34, 116.67, 75.0, 225.0, 183.33, 150.0, 166.67, 183.33, 225.0, 216.67, 216.67, 225.0, 241.67, 383.33, 333.34, 141.67, 166.67, 283.34, 216.67, 275.0, 275.0, 325.0, 275.0, 208.33, 283.34, 283.33, 283.33, 275.0, 275.0, 266.67, 316.67, 266.67, 333.33, 383.33, 366.67, 416.66, 283.34, 266.67, 308.33, 291.67, 250.0, 233.33, 333.34, 266.66, 233.33, 250.0, 275.0, 191.67, 216.67, 200.0, 216.67, 200.0, 166.67, 133.33, 241.67, 141.67, 150.0, 183.33, 191.67, 291.66, 358.34, 241.66, 325.0, 375.0, 325.0, 325.0, 491.66, 291.67, 341.67, 300.0, 358.33, 333.33, 333.33, 258.33, 333.34, 283.34, 316.66, 266.67, 250.0, 275.0, 333.33, 216.66, 191.67, 366.66, 283.33, 200.0, 216.67, 366.67, 191.67, 91.66, 116.66, 108.33, 125.0, 150.0, 91.67, 91.67, 133.34, 116.67, 75.0, 225.0, 183.33, 150.0, 166.67, 183.33, 225.0, 216.67, 216.67, 225.0, 241.67, 383.33, 333.34, 141.67, 166.67, 283.34, 216.67, 275.0, 275.0, 325.0, 275.0, 208.33, 283.34, 283.33, 283.33, 275.0, 275.0, 266.67, 316.67, 266.67, 333.33, 383.33, 366.67, 416.66, 283.34, 266.67, 308.33, 291.67, 250.0, 233.33, 333.34, 266.66, 233.33, 250.0, 275.0, 191.67, 216.67, 200.0, 216.67, 200.0, 166.67, 133.33, 241.67, 141.67, 150.0, 183.33, 191.67, 291.66, 358.34, 241.66, 325.0, 375.0, 325.0, 325.0, 491.66, 291.67, 341.67, 300.0, 358.33, 333.33, 333.33, 258.33, 333.34, 283.34, 316.66, 266.67, 241.67, 233.33, 233.34, 275.0, 258.33, 266.67, 525.0, 241.67, 158.33, 141.67, 133.33, 150.0, 141.67, 100.0, 158.34, 275.0, 216.67, 225.0, 233.34, 166.67, 75.0, 200.0, 216.67, 141.67, 133.34, 133.33, 200.0, 191.66, 175.0, 158.33, 225.0, 191.67, 166.66, 183.34, 408.33, 258.33, 316.66, 225.0, 275.0, 383.33, 250.0, 308.33, 375.0, 416.67, 491.67, 541.67, 441.66, 575.0, 516.67, 358.34, 383.33, 441.67, 458.34, 483.34, 433.33, 383.34, 366.67, 391.67, 333.33, 383.34, 441.67, 275.0, 225.0, 475.0, 391.67, 366.67, 241.66, 158.33, 225.0, 141.67, 116.67, 158.34, 191.67, 116.67, 141.67, 116.67, 158.33, 191.67, 166.66, 191.67, 258.33, 208.34, 191.67, 258.33, 216.67, 200.0, 241.67, 225.0, 191.67, 191.66, 183.34, 200.0, 116.67, 200.0, 283.34, 341.66, 183.34, 125.0, 133.33, 241.66, 191.67, 200.0, 566.66, 216.67, 108.34, 150.0, 116.67, 125.0, 141.66, 258.33, 141.66, 233.34, 200.0, 225.0, 266.67, 183.33, 191.67, 216.67, 216.67, 125.0, 116.66, 141.67, 241.66, 175.0, 166.66, 233.33, 258.34, 183.34, 258.34, 241.66, 250.0, 300.0, 233.67665441764848, 233.67665441764848, 233.67665441764848, 233.67665441764848, 233.67665441764848, 233.67665441764848, 233.67665441764848, 233.6766544176485, 233.6766544176485, 233.6766544176485, 325.0, 291.67, 375.0, 325.0, 366.67, 358.34, 350.0, 366.66, 250.0, 258.34, 266.66, 225.0, 283.34, 266.67, 208.33, 258.34, 258.33, 225.0, 258.33, 258.33, 250.0, 183.33, 175.0, 275.0, 166.67, 150.0, 458.33, 1150.0, 433.33, 216.67, 233.33, 275.0, 225.0, 325.0, 250.0, 258.34, 291.67, 283.34, 316.67, 358.33, 358.33, 541.66, 308.34, 283.33, 300.0, 500.0, 166.67, 191.67, 175.0, 166.67, 125.0, 141.66, 216.67, 200.0, 141.66, 166.67, 166.66, 200.0, 116.66, 158.34, 208.33, 150.0, 125.0, 216.67, 350.0, 158.33, 141.67, 141.67, 175.0, 133.34, 166.66, 158.34, 125.0, 158.34, 166.67, 133.33, 283.34, 208.34, 133.33, 108.34, 158.33, 200.0, 183.33, 158.33, 233.33, 233.34, 234.86740438764082, 234.86740438764082, 234.86740438764082, 234.86740438764082, 234.86740438764082, 234.86740438764082, 234.86740438764082, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764085, 234.86740438764087, 234.86740438764087, 234.86740438764087, 234.86740438764087, 234.86740438764087, 234.86740438764087, 234.86740438764087, 258.33, 325.0, 225.0, 258.34, 225.0, 241.67, 341.66, 166.66, 191.67, 216.67, 133.34, 133.34, 166.67, 183.34, 175.0, 183.33, 250.0, 175.0, 191.67, 241.67, 183.33, 241.67, 208.34, 191.67, 191.66, 183.34, 325.0, 200.0, 216.67, 291.67, 325.0, 283.33, 325.0, 358.33, 275.0, 200.0, 375.0, 333.34, 233.33, 300.0, 350.0, 333.34, 291.66, 216.67, 141.67, 125.0, 141.67, 158.33, 100.0, 133.33, 308.33, 91.66, 150.0, 141.66, 183.34, 150.0, 91.66, 166.67, 150.0, 83.33, 133.34, 158.34, 100.0, 150.0, 183.33, 191.67, 166.67, 175.0, 233.33, 183.33, 208.34, 233.33, 200.0, 233.33, 208.34, 216.67, 216.66, 200.0, 258.33, 291.67, 225.0, 283.33, 300.0, 241.67, 266.67, 283.33, 283.34, 266.66, 266.67, 325.0, 225.0, 200.0, 275.0, 241.67, 233.33, 200.0, 216.67, 275.0, 208.33, 191.67, 166.67, 116.66, 175.0, 200.0, 116.66, 191.66, 291.66, 266.67, 333.33, 325.0, 358.34, 275.0, 225.0, 283.33, 266.66, 258.33, 266.67, 383.33, 358.34, 408.33, 508.34000000000003, 616.66, 233.34, 258.33, 400.0, 441.66, 391.67, 358.33, 266.67, 266.66, 350.0, 358.34, 291.66, 283.33, 416.66, 666.67, 308.33, 300.0, 375.0, 225.0, 125.0, 100.0, 166.67, 225.0, 300.0, 216.67, 275.0, 200.0, 191.67, 241.67, 200.0, 216.66, 125.0, 166.66, 316.66, 200.0, 208.33, 233.33, 158.33, 158.33, 216.66, 183.33, 150.0, 183.33, 183.34, 175.0, 191.66, 191.66, 283.33, 325.0, 300.0, 333.33, 375.0, 308.34, 366.67, 375.0, 333.33, 333.34, 283.34, 341.67, 316.67, 316.66, 350.0, 341.67, 300.0, 300.0, 300.0, 241.67, 233.33, 258.33, 316.67, 275.0, 208.33, 275.0, 266.67, 208.33, 233.33, 233.34, 166.66, 166.66, 166.66, 166.67, 175.0, 150.0, 191.67, 216.66, 225.0, 200.0, 250.0, 175.0, 225.0, 225.0, 208.34, 241.67, 216.67, 216.67, 225.0, 225.0, 291.66, 283.33, 333.33, 283.34, 200.0, 191.67, 458.34, 166.67, 166.67, 175.0, 108.33, 141.66, 200.0, 133.34, 125.0, 216.67, 200.0, 183.34, 150.0, 191.67, 191.67, 183.33, 141.67, 158.33, 100.0, 100.0, 166.67, 91.67, 108.34, 158.34, 250.0, 208.33, 250.0, 208.33, 258.34, 275.0, 233.33, 291.66, 325.0, 125.0, 141.66, 241.67, 208.33, 158.33, 175.0, 175.0, 175.0, 200.0, 166.66, 233.33, 216.67, 175.0, 191.67, 350.0, 233.34, 208.33, 216.67, 325.0, 308.33, 291.67, 266.67, 316.67, 266.66, 250.0, 258.33, 291.66, 250.0, 233.33, 250.0, 250.0, 216.66, 208.33, 216.66, 233.33, 200.0, 308.33, 200.0, 150.0, 166.66, 191.66, 208.33, 225.0, 283.34, 225.0, 258.34, 275.0, 233.34, 225.0, 250.0, 216.67, 225.0, 233.33, 216.66, 166.66, 150.0, 234.9071369431145, 234.90713694311447, 234.90713694311447, 234.90713694311444, 234.90713694311444, 234.9071369431144, 234.9071369431144, 234.90713694311438, 166.67, 166.67, 175.0, 108.33, 141.66, 200.0, 133.34, 125.0, 216.67, 200.0, 183.34, 150.0, 191.67, 191.67, 183.33, 141.67, 158.33, 100.0, 100.0, 166.67, 91.67, 108.34, 158.34, 250.0, 208.33, 250.0, 208.33, 258.34, 275.0, 233.33, 291.66, 325.0, 125.0, 141.66, 241.67, 208.33, 158.33, 175.0, 175.0, 175.0, 200.0, 166.66, 233.33, 216.67, 175.0, 191.67, 350.0, 233.34, 208.33, 216.67, 325.0, 308.33, 291.67, 266.67, 316.67, 266.66, 250.0, 258.33, 291.66, 250.0, 233.33, 250.0, 250.0, 216.66, 208.33, 216.66, 233.33, 200.0, 308.33, 200.0, 150.0, 166.66, 191.66, 208.33, 225.0, 283.34, 225.0, 258.34, 275.0, 233.34, 225.0, 250.0, 216.67, 225.0, 233.33, 216.66, 166.66, 150.0, 233.3857216946886, 233.3857216946886, 233.3857216946886, 233.38572169468858, 233.38572169468858, 233.38572169468858, 233.38572169468856, 233.38572169468856, 233.38572169468853, 233.38572169468853, 233.38572169468853, 233.3857216946885, 233.3857216946885, 233.3857216946885, 233.38572169468847, 233.38572169468847, 233.38572169468847, 233.38572169468844, 233.38572169468844, 233.3857216946884, 233.3857216946884, 233.3857216946884, 233.38572169468839, 233.38572169468839, 233.38572169468839, 233.38572169468836, 233.38572169468836, 166.67, 100.0, 133.34, 100.0, 191.67, 216.67, 283.33, 225.0, 308.33, 225.0, 275.0, 200.0, 216.66, 391.67, 316.67, 158.33, 200.0, 216.67, 291.66, 308.34, 216.67, 175.0, 175.0, 366.66, 183.33, 141.67, 191.66, 141.67, 191.66, 175.0, 191.67, 158.34, 191.67, 225.0, 158.34, 108.33, 141.67, 116.67, 183.34, 166.66, 125.0, 116.67, 166.67, 158.33, 191.67, 141.67, 125.0, 158.33, 175.0, 108.33, 116.67, 150.0, 133.33, 158.33, 133.34, 158.34, 125.0, 158.33, 158.33, 141.67, 141.67, 133.33, 200.0, 141.67, 100.0, 133.33, 208.34, 133.34, 116.66, 208.33, 133.34, 125.0, 125.0, 166.66, 158.34, 166.66, 291.66, 125.0, 158.33, 141.67, 133.34, 116.67, 158.33, 166.67, 133.34, 141.67, 125.0, 183.34, 133.34, 116.67, 133.33, 200.0, 141.67, 108.34, 150.0, 133.33, 133.33, 133.33, 158.33, 125.0, 108.34, 175.0, 141.67, 116.67, 125.0, 175.0, 141.66, 133.34, 141.66, 175.0, 216.66, 150.0, 141.67, 191.67, 250.0, 233.34, 208.33, 216.67, 250.0, 266.67, 266.66, 266.67, 241.67, 241.67, 183.33, 175.0, 216.66, 266.66, 191.67, 258.33, 366.66, 300.0, 283.33, 291.67, 283.34, 333.33, 258.33, 233.33, 233.33, 250.0, 241.67, 200.0, 175.0, 233.33, 208.33, 150.0, 175.0, 175.0, 166.67, 133.33, 166.67, 133.33, 158.33, 158.34, 125.0, 141.67, 225.0, 125.0, 125.0, 150.0, 141.67, 141.67, 166.66, 183.33, 133.33, 175.0, 166.66, 133.34, 125.0, 158.34, 150.0, 150.0, 100.0, 183.34, 158.33, 141.67, 133.33, 175.0, 166.67, 125.0, 158.34, 116.67, 175.0, 158.33, 108.33, 116.67, 175.0, 166.66, 108.34, 150.0, 183.33, 166.66, 233.34, 125.0, 141.67, 158.33, 116.66, 133.33, 125.0, 116.67, 133.34, 141.67, 108.33, 125.0, 208.33, 183.33, 175.0, 200.0, 200.0, 225.0, 241.66, 208.34, 241.67, 266.66, 250.0, 250.0, 266.67, 308.34, 291.67, 241.67, 275.0, 300.0, 258.33, 275.0, 350.0, 300.0, 266.66, 258.34, 258.33, 275.0, 266.67, 250.0, 266.67, 283.34, 225.0, 200.0, 233.34, 241.67, 191.66, 175.0, 200.0, 208.33, 183.33, 150.0, 175.0, 183.33, 150.0, 116.66, 125.0, 191.66, 133.33, 100.0, 158.33, 175.0, 125.0, 283.34, 183.33, 200.0, 191.66, 158.34, 150.0, 191.67, 166.67, 100.0, 158.33, 158.33, 141.67, 133.33, 150.0, 141.66, 175.0, 158.34, 133.34, 125.0, 208.33, 108.33, 125.0, 175.0, 141.67, 125.0, 158.33, 141.67, 133.33, 166.67, 166.67, 125.0, 133.33, 175.0, 125.0, 125.0, 116.67, 158.33, 133.33, 125.0, 141.67, 133.33, 158.34, 158.33, 116.66, 116.67, 191.67, 183.33, 158.33, 200.0, 225.0, 208.33, 200.0, 216.67, 283.34, 258.34, 241.66, 300.0, 275.0, 241.66, 275.0, 258.33, 283.34, 275.0, 366.67, 250.0, 275.0, 208.33, 208.33, 300.0, 233.33, 233.33, 216.67, 233.33, 233.33, 208.33, 166.66, 241.67, 191.66, 150.0, 175.0, 225.0, 166.67, 208.34, 150.0, 175.0, 175.0, 116.66, 116.67, 191.67, 125.0, 116.66, 158.34, 150.0, 125.0, 183.34, 133.33, 141.67, 158.33, 141.67, 133.33, 191.67, 133.34, 125.0, 175.0, 150.0, 108.34, 166.67, 150.0, 158.34, 141.66, 125.0, 108.34, 166.66, 125.0, 100.0, 141.66, 158.34, 100.0, 141.67, 166.66, 158.34, 141.67, 150.0, 108.34, 166.67, 133.33, 108.33, 108.34, 158.34, 125.0, 133.33, 116.67, 191.67, 133.33, 100.0, 125.0, 150.0, 116.66, 300.0, 91.67, 125.0, 150.0, 166.67, 183.33, 208.33, 191.66, 191.67, 216.67, 183.33, 208.33, 216.66, 241.67, 225.0, 208.33, 250.0, 250.0, 216.67, 275.0, 291.66, 216.67, 275.0, 208.33, 250.0, 250.0, 200.0, 208.33, 283.33, 183.33, 208.33, 283.34, 225.0, 200.0, 208.33, 200.0, 208.34, 158.33, 158.33, 233.34, 166.67, 116.66, 158.34, 191.66, 125.0, 166.67, 150.0, 175.0, 166.67, 133.34, 133.33, 200.0, 125.0, 116.67, 158.34, 191.66, 133.33, 233.34, 183.33, 216.66, 408.34, 325.0, 175.0, 183.33, 175.0, 125.0, 141.67, 183.33, 150.0, 141.67, 125.0, 150.0, 125.0, 108.34, 158.33, 133.33, 125.0, 133.34, 183.34, 125.0, 133.33, 108.34, 150.0, 125.0, 100.0, 133.34, 91.66, 141.67, 125.0, 108.33, 91.66, 158.33, 150.0, 83.33, 91.66, 125.0, 291.66, 91.67, 75.0, 141.67, 341.66, 200.0, 200.0, 208.34, 225.0, 225.0, 208.33, 216.66, 266.67, 250.0, 216.66, 233.33, 266.67, 258.33, 225.0, 241.66, 283.33, 258.34, 191.67, 250.0, 216.66, 241.67, 216.67, 175.0, 200.0, 258.33, 175.0, 258.33, 233.34, 208.34, 183.34, 208.33, 158.33, 200.0, 208.33, 275.0, 483.34, 575.0, 175.0, 125.0, 133.33, 116.67, 133.34, 125.0, 116.66, 116.67, 133.34, 191.66, 191.67, 166.66, 216.67, 166.66, 183.34, 166.66, 208.34, 125.0, 100.0, 141.67, 108.34, 133.33, 133.33, 166.67, 216.67, 191.67, 133.33, 100.0, 116.67, 158.34, 125.0, 108.33, 116.67, 133.34, 166.67, 91.66, 116.67, 108.34, 158.33, 133.33, 133.33, 108.33, 108.34, 158.34, 83.33, 100.0, 116.67, 141.67, 91.66, 108.34, 191.67, 158.33, 175.0, 233.33, 258.33, 150.0, 216.67, 191.66, 175.0, 266.67, 308.34, 225.0, 217.82022098112213, 217.82022098112216, 217.82022098112216, 217.82022098112216, 217.8202209811222, 217.8202209811222, 217.8202209811222, 217.82022098112222, 217.82022098112222, 217.82022098112222, 217.82022098112222, 217.82022098112225, 217.82022098112225, 217.82022098112225, 217.82022098112228, 217.82022098112228, 458.34, 275.0, 291.67, 550.0, 291.67, 275.0, 341.67, 341.66, 283.34, 233.34, 291.67, 316.67, 200.0, 266.66, 341.67, 375.0, 275.0, 200.0, 258.34, 183.33, 216.67, 308.34, 366.66, 258.33, 216.67, 308.33, 366.66, 250.0, 333.33, 391.66, 408.33, 258.33, 208.34, 183.33, 241.67, 300.0, 233.33, 266.67, 266.66, 225.0, 225.0, 325.0, 358.33, 366.67, 250.0, 266.67, 333.34, 325.0, 275.0, 308.34, 366.67, 608.33, 391.67, 275.0, 258.34, 158.33, 158.33, 133.33, 133.33, 100.0, 225.0, 233.33, 191.67, 233.33, 316.67, 358.33, 408.33, 291.66, 258.33, 241.67, 183.33, 208.34, 200.0, 233.33, 200.0, 216.66, 233.33, 300.0, 241.66, 283.33, 375.0, 416.67, 425.0, 383.34, 458.33, 566.67, 500.0, 350.0, 366.67, 341.66, 291.67, 416.67, 308.33, 333.33, 375.0, 358.33, 350.0, 391.67, 300.0, 333.33, 350.0, 308.33, 308.34, 333.33, 300.0, 391.67, 283.33, 250.0, 258.33, 200.0, 158.33, 183.33, 175.0, 125.0, 158.33, 141.67, 141.66, 133.34, 108.33, 125.0, 191.67, 125.0, 150.0, 141.66, 200.0, 183.33, 183.33, 200.0, 225.0, 208.33, 241.66, 291.67, 308.33, 300.0, 241.67, 241.67, 283.33, 225.0, 300.0, 166.67, 166.66, 125.0, 158.33, 125.0, 216.66, 200.0, 525.0, 225.0, 175.0, 91.67, 91.66, 150.0, 125.0, 108.33, 150.0, 166.67, 191.67, 225.0, 166.66, 166.66, 208.33, 133.33, 150.0, 125.0, 125.0, 108.33, 125.0, 283.34, 200.0, 216.67, 200.0, 183.33, 191.67, 166.67, 200.0, 200.0, 216.67, 216.67, 208.34, 208.34, 300.0, 266.67, 241.66, 300.0, 291.67, 225.0, 283.33, 258.34, 275.0, 266.66, 216.67, 275.0, 225.0, 175.0, 233.33, 283.33, 241.67, 216.67, 216.67, 266.67, 208.33, 183.33, 216.66, 191.66, 158.33, 191.67, 233.33, 208.33, 191.66, 150.0, 175.0, 158.34, 125.0, 125.0, 183.33, 150.0, 133.33, 141.67, 158.34, 150.0, 258.33, 333.33, 250.0, 191.67, 116.67, 141.66, 150.0, 108.33, 108.34, 166.67, 150.0, 141.67, 125.0, 125.0, 141.66, 141.67, 75.0, 166.67, 133.33, 100.0, 116.67, 183.33, 125.0, 133.33, 108.33, 150.0, 141.66, 108.33, 108.34, 175.0, 108.33, 91.66, 133.34, 158.33, 125.0, 141.66, 91.66, 150.0, 141.66, 75.0, 116.67, 341.67, 183.33, 216.67, 166.66, 150.0, 116.67, 166.67, 158.33, 216.66, 183.33, 219.18943043159913, 219.18943043159913, 219.18943043159913, 219.1894304315991, 219.1894304315991, 219.1894304315991, 219.1894304315991, 219.18943043159908, 219.18943043159908, 219.18943043159908, 219.18943043159908, 219.18943043159908, 219.18943043159905, 219.18943043159905, 219.18943043159905, 219.18943043159905, 219.18943043159902, 219.18943043159902, 219.18943043159902, 219.18943043159902, 275.0, 325.0, 233.34, 216.67, 241.67, 266.66, 191.67, 225.0, 200.0, 225.0, 175.0, 208.33, 208.34, 333.33, 141.67, 100.0, 150.0, 158.34, 100.0, 150.0, 183.33, 200.0, 233.33, 200.0, 216.67, 191.67, 125.0, 133.33, 150.0, 158.33, 150.0, 150.0, 175.0, 141.66, 150.0, 141.67, 191.67, 175.0, 208.33, 275.0, 216.67, 266.66, 283.33, 241.67, 225.0, 275.0, 275.0, 241.66, 250.0, 350.0, 258.33, 150.0, 116.67, 191.67, 108.33, 83.33, 175.0, 108.33, 100.0, 141.67, 258.33, 133.33, 141.66, 100.0, 166.67, 133.33, 91.67, 133.34, 150.0, 166.67, 208.33, 200.0, 191.66, 225.0, 200.0, 241.66, 358.33, 241.67, 291.66, 358.33, 216.67, 258.34, 250.0, 258.34, 275.0, 250.0, 275.0, 233.33, 233.33, 325.0, 450.0, 350.0, 300.0, 508.34000000000003, 358.33, 275.0, 241.66, 300.0, 233.34, 233.33, 350.0, 291.66, 266.67, 341.66, 391.66, 233.33, 216.67, 183.34, 258.33, 175.0, 116.66, 116.67, 191.67, 75.0, 116.67, 166.66, 225.0, 191.67, 250.0, 200.0, 258.33, 225.0, 241.66, 266.67, 316.66, 233.34, 233.34, 258.34, 266.66, 200.0, 241.66, 233.33, 250.0, 225.0, 366.67, 433.33, 308.34, 258.34, 366.66, 333.33, 208.34, 300.0, 383.33, 758.33, 383.33, 258.33, 208.33, 275.0, 116.67, 133.33, 183.33, 141.67, 166.66, 208.33, 183.33, 191.66, 250.0, 133.33, 175.0, 283.34, 125.0, 150.0, 175.0, 175.0, 158.33, 183.33, 225.0, 308.33, 158.33, 191.67, 283.33, 258.33, 233.34, 241.67, 383.34, 300.0, 316.67, 675.0, 450.0, 366.67, 558.33, 400.0, 391.67, 333.33, 366.67, 316.67, 325.0, 300.0, 408.34, 341.67, 266.66, 241.66, 275.0, 200.0, 191.66, 216.67, 333.33, 175.0, 183.33, 175.0, 166.67, 175.0, 166.66, 183.34, 166.67, 166.66, 166.67, 191.66, 141.67, 175.0, 150.0, 258.33, 191.66, 175.0, 208.33, 225.0, 158.34, 183.34, 200.0, 166.66, 183.34, 216.67, 233.33, 191.66, 183.34, 250.0, 325.0, 166.67, 175.0, 200.0, 225.0, 233.34, 225.0, 291.67, 250.0, 183.33, 275.0, 316.66, 208.33, 300.0, 308.33, 208.34, 333.33, 208.34, 175.0, 183.33, 158.33, 141.67, 183.34, 125.0, 83.33, 133.33, 175.0, 100.0, 116.67, 108.33, 300.0, 125.0, 100.0, 100.0, 241.67, 400.0, 233.33, 266.67, 333.34, 258.33, 233.33, 250.0, 250.0, 266.67, 200.0, 275.0, 300.0, 266.66, 275.0, 333.33, 275.0, 283.33, 383.34, 308.34, 266.67, 241.67, 233.33, 275.0, 241.66, 208.34, 241.67, 233.34, 300.0, 200.0, 225.0, 191.67, 175.0, 200.0, 200.0, 133.33, 150.0, 166.67, 141.66, 141.67, 175.0, 158.33, 200.0, 208.34, 191.67, 191.66, 175.0, 150.0, 166.66, 200.0, 183.33, 175.0, 175.0, 208.34, 200.0, 183.33, 158.33, 308.33, 300.0, 300.0, 341.66, 220.3575739718662, 220.3575739718662, 220.35757397186623, 220.35757397186626, 220.35757397186626, 220.3575739718663, 220.3575739718663, 220.35757397186632, 220.35757397186634, 220.35757397186634, 220.35757397186637, 220.35757397186637, 220.3575739718664, 220.3575739718664, 220.35757397186643, 220.35757397186646, 220.35757397186646, 220.3575739718665, 220.3575739718665, 220.35757397186651, 220.35757397186654, 220.35757397186654, 220.35757397186657, 220.35757397186657, 220.3575739718666, 220.3575739718666, 220.35757397186663, 220.35757397186666, 220.35757397186666, 220.35757397186669, 220.35757397186669, 220.35757397186669, 220.35757397186669, 220.3575739718667, 220.35757397186674, 220.35757397186674, 220.35757397186677, 220.35757397186677, 220.3575739718668, 220.3575739718668, 220.35757397186683, 220.35757397186686, 220.35757397186686, 220.35757397186688, 220.35757397186688, 220.3575739718669, 220.3575739718669, 220.35757397186694, 258.33, 333.33, 416.66, 266.67, 366.66, 358.33, 341.66, 341.66, 300.0, 266.66, 375.0, 308.34, 225.0, 216.67, 233.33, 200.0, 291.66, 233.34, 166.66, 200.0, 191.67, 208.33, 175.0, 200.0, 283.34, 358.33, 341.67, 341.67, 275.0, 125.0, 166.66, 166.66, 100.0, 116.67, 166.67, 116.67, 150.0, 141.67, 150.0, 125.0, 108.33, 116.67, 183.34, 116.66, 108.34, 216.67, 150.0, 133.33, 216.66, 208.33, 166.67, 166.66, 150.0, 291.66, 333.33, 250.0, 220.42098361552073, 220.42098361552075, 220.42098361552075, 220.42098361552078, 220.42098361552078, 220.4209836155208, 220.4209836155208, 220.4209836155208, 220.42098361552084, 220.42098361552084, 220.42098361552087, 220.42098361552087, 220.4209836155209, 220.4209836155209, 220.4209836155209, 220.42098361552092, 220.42098361552092, 220.42098361552095, 220.42098361552095, 220.42098361552098, 220.42098361552098, 220.42098361552098, 220.420983615521, 220.420983615521, 220.42098361552104, 220.42098361552104, 220.42098361552107, 220.42098361552107, 220.42098361552107, 220.4209836155211, 220.4209836155211, 220.42098361552112, 220.42098361552112, 220.42098361552115, 220.42098361552115, 220.42098361552115, 220.42098361552118, 220.42098361552118, 233.33, 266.67, 250.0, 258.34, 200.0, 275.0, 300.0, 233.33, 241.67, 341.67, 250.0, 233.33, 266.67, 250.0, 241.67, 241.67, 283.33, 308.33, 258.33, 233.34, 250.0, 241.66, 225.0, 258.33, 241.67, 175.0, 191.66, 216.66, 150.0, 325.0, 175.0, 200.0, 191.67, 300.0, 308.34, 150.0, 175.0, 383.33, 116.66, 133.33, 133.34, 133.33, 108.34, 141.67, 125.0, 158.34, 125.0, 100.0, 125.0, 183.33, 175.0, 225.0, 133.33, 150.0, 166.67, 258.33, 250.0, 250.0, 200.0, 200.0, 175.0, 175.0, 250.0, 200.0, 483.34, 241.67, 175.0, 141.67, 183.33, 233.33, 241.67, 191.66, 158.34, 191.66, 216.66, 250.0, 166.67, 175.0, 200.0, 225.0, 191.67, 133.33, 183.33, 241.67, 125.0, 125.0, 100.0, 100.0, 116.66, 291.67, 141.67, 166.67, 191.66, 183.33, 216.67, 233.33, 241.66, 225.0, 275.0, 241.67, 200.0, 208.33, 166.67, 258.33, 275.0, 150.0, 225.0, 241.67, 275.0, 250.0, 216.67, 291.66, 283.34, 250.0, 191.67, 208.33, 216.67, 175.0, 200.0, 175.0, 175.0, 158.34, 233.33, 191.67, 150.0, 141.66, 166.67, 183.33, 91.67, 116.67, 125.0, 141.67, 141.67, 83.33, 116.67, 175.0, 108.33, 100.0, 166.67, 150.0, 200.0, 208.33, 183.34, 183.33, 191.67, 150.0, 219.48696084426265, 219.48696084426268, 219.48696084426268, 219.48696084426268, 219.48696084426268, 219.48696084426268, 219.48696084426268, 219.48696084426268, 219.48696084426268, 219.48696084426268, 219.48696084426268, 219.48696084426268, 219.4869608442627, 219.4869608442627, 219.4869608442627, 219.4869608442627, 219.4869608442627, 219.48696084426274, 219.48696084426274, 219.48696084426274, 219.48696084426274, 219.48696084426274, 219.48696084426277, 219.48696084426277, 219.48696084426277, 219.48696084426277, 219.48696084426277, 219.4869608442628, 219.4869608442628, 219.4869608442628, 219.4869608442628, 219.4869608442628, 219.4869608442628, 219.48696084426282, 219.48696084426282, 219.48696084426282, 219.48696084426282, 219.48696084426282, 219.48696084426285, 219.48696084426285, 219.48696084426285, 219.48696084426285, 219.48696084426285, 219.48696084426288, 219.48696084426288, 219.48696084426288, 233.33, 266.67, 250.0, 258.34, 200.0, 275.0, 300.0, 233.33, 241.67, 341.67, 250.0, 233.33, 266.67, 250.0, 241.67, 241.67, 283.33, 308.33, 258.33, 233.34, 250.0, 241.66, 225.0, 258.33, 241.67, 175.0, 191.66, 216.66, 150.0, 325.0, 175.0, 200.0, 191.67, 300.0, 308.34, 150.0, 175.0, 383.33, 116.66, 133.33, 133.34, 133.33, 108.34, 141.67, 125.0, 158.34, 125.0, 100.0, 125.0, 183.33, 175.0, 225.0, 133.33, 150.0, 166.67, 258.33, 250.0, 250.0]
    filtered_flex = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1129.2855555555557, 1104.2755555555557, 1137.6155555555556, 1104.2755555555557, 1054.2755555555557, 1012.6155555555556, 962.6155555555556, 945.9555555555554, 1037.6155555555556, 562.6155555555556, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1130.841189814815, 1105.831189814815, 1139.1711898148149, 1105.831189814815, 1055.831189814815, 1014.171189814815, 964.171189814815, 947.5111898148149, 1039.1711898148149, 564.1711898148151, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1750.190115597851, 1116.8501155978513, 1350.180115597851, 1100.180115597851, 958.5101155978513, 1200.190115597851, 1058.5101155978512, 1108.5101155978512, 1200.180115597851, 1000.190115597851, 1233.5201155978511, 1216.850115597851, 933.5201155978511, 1283.5201155978511, 1383.5201155978511, 891.850115597851, 1275.180115597851, 1175.180115597851, 1000.1801155978511, 1233.5201155978511, 1033.5201155978511, 1258.520115597851, 1308.520115597851, 875.1901155978508, 1266.8501155978508, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1282.544948739397, 1332.544948739397, 1224.214948739397, 1174.214948739397, 1282.554948739397, 1249.2149487393972, 1390.884948739397, 1390.884948739397, 1115.884948739397, 1274.214948739397, 974.214948739397, 1099.214948739397, 890.884948739397, 1174.214948739397, 882.544948739397, 1157.544948739397, 1149.214948739397, 1215.8749487393973, 690.8749487393969, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 791.3233455823514, 974.6533455823514, 1207.9933455823516, 824.6533455823514, 924.6533455823513, 941.3233455823515, 891.3233455823515, 891.3233455823515, 874.6533455823516, 791.3233455823514, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 781.8025956123591, 831.7925956123593, 865.1325956123592, 873.4625956123592, 823.472595612359, 881.8025956123591, 881.8025956123591, 848.4725956123591, 906.7925956123593, 931.8025956123593, 890.1325956123592, 915.1325956123591, 898.4625956123591, 931.8025956123593, 881.8025956123591, 915.1325956123591, 956.7925956123593, 831.8025956123591, 898.4625956123591, 840.1325956123591, 856.8025956123593, 856.8025956123593, 873.4625956123592, 931.7925956123592, 865.1325956123592, 873.4625956123592, 548.4625956123592, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1715.0928630568853, 1165.0928630568856, 1206.7528630568859, 1031.7628630568856, 990.0928630568857, 1206.7528630568859, 1081.7628630568856, 948.4328630568855, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1716.6142783053112, 1166.6142783053112, 1208.2742783053116, 1033.2842783053113, 991.6142783053115, 1208.2742783053116, 1083.2842783053113, 949.9542783053113, 1174.9542783053114, 1149.9442783053114, 883.2742783053114, 1183.2842783053118, 1158.2742783053118, 891.6142783053115, 1158.2742783053118, 1124.9442783053116, 899.9542783053116, 1208.2742783053118, 1158.2742783053118, 874.9542783053115, 1183.2842783053118, 1191.6142783053117, 833.2842783053115, 1166.6142783053115, 1191.6142783053117, 833.2842783053115, 1149.9442783053116, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 565.5197790188779, 1032.1797790188778, 1032.1797790188778, 1115.5097790188777, 1107.1797790188778, 1032.1797790188778, 1082.1797790188778, 1123.8397790188778, 1073.8497790188778, 1057.1797790188778, 1157.1797790188778, 1107.1797790188778, 1107.1797790188778, 1115.5097790188777, 1115.5097790188777, 1148.8497790188778, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 814.1405695684008, 914.1405695684008, 914.1405695684008, 855.8105695684009, 922.4805695684008, 930.8105695684008, 947.470569568401, 964.1505695684008, 939.1505695684008, 980.8105695684009, 989.1405695684008, 914.1405695684008, 922.4805695684008, 1005.810569568401, 930.8105695684008, 972.4805695684009, 997.4805695684012, 1047.470569568401, 997.4805695684012, 939.1405695684009, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1037.9724260281337, 846.3124260281338, 1046.3124260281338, 1012.9724260281339, 879.6424260281339, 954.6424260281337, 887.9824260281335, 904.6424260281337, 846.3124260281336, 812.9824260281335, 854.6424260281335, 862.9724260281336, 837.9724260281336, 912.9724260281336, 1237.9724260281334, 887.9824260281334, 829.6424260281336, 846.3024260281337, 804.6424260281334, 829.6424260281335, 846.3024260281337, 821.3024260281335, 812.9824260281333, 896.3124260281335, 929.6424260281333, 879.6424260281335, 871.3024260281335, 904.6424260281334, 862.9724260281333, 837.9724260281333, 871.3124260281335, 812.9724260281331, 804.6424260281332, 829.6424260281333, 987.9824260281332, 1012.9724260281332, 896.3024260281331, 837.9724260281331, 871.3124260281334, 912.9824260281332, 887.9724260281332, 979.6424260281332, 937.9824260281331, 946.3024260281331, 954.6424260281332, 1387.9724260281332, 1104.642426028133, 804.642426028133, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1004.5790163844795, 1046.249016384479, 1154.579016384479, 1062.909016384479, 1154.579016384479, 1154.579016384479, 821.2490163844792, 1187.909016384479, 1071.239016384479, 937.909016384479, 1146.249016384479, 1004.5790163844792, 1029.579016384479, 1187.9190163844792, 937.909016384479, 1096.2390163844793, 1129.5790163844792, 846.249016384479, 1171.2390163844793, 1062.9190163844792, 854.579016384479, 1137.9190163844787, 937.9090163844788, 1096.239016384479, 1162.909016384479, 912.9090163844788, 1112.919016384479, 1162.909016384479, 871.239016384479, 1154.579016384479, 1129.579016384479, 921.2490163844789, 1204.579016384479, 1146.2490163844789, 971.2390163844791, 1196.2390163844789, 1012.9190163844788, 712.9190163844788, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1447.1730391557373, 1322.1730391557373, 1063.8430391557372, 930.5130391557373, 1230.5130391557373, 988.8430391557372, 980.5130391557373, 1205.5130391557375, 1005.5130391557374, 1047.1830391557373, 1155.5130391557373, 1063.8430391557372, 1155.5130391557373, 1155.5130391557373, 822.1830391557374, 1188.8430391557372, 1072.1730391557373, 938.8430391557371, 1147.1830391557373, 1005.5130391557374, 1030.5130391557373, 1188.8530391557372, 938.8430391557371, 1097.1730391557376, 1130.5130391557375, 847.1830391557372, 1172.1730391557371, 1063.853039155737, 855.5130391557371, 1138.853039155737, 938.8430391557371, 1097.1730391557373, 1163.843039155737, 913.8430391557371, 1113.8530391557372, 1163.843039155737, 872.1730391557372, 1155.513039155737, 1130.5130391557373, 922.1830391557371, 1205.5130391557373, 1147.183039155737, 972.1730391557372, 1197.1730391557371, 1013.853039155737, 713.8530391557372, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    #filtered_flex_nozeroes = [i for i in filtered_flex if i != 0]

    # avg duration: 23.384615384615383
    # avg charge: 23.95680254265759

    filtered_flex_nozeroes = [1041.5]*23


    #baseForecast = baseForecast*8

    #settings 
    weight1 = 1 #importance of cost 
    weight2 = 0.5 #importance of renewable integ
    weight3 = 0.5 #importance of shutoff
    lowerLimit = 20
    maximumLimit = 100
    shutOffRisk = 0
    idealReserveThreshold = 80
    

    #4 powerwalls = 4*13.5kwH = 54kWh 
    batterySize = 54000
    currentBatteryState1, currentBatteryState2, originalBatteryState = 0.49*batterySize, 0.49*batterySize, 0.49*batterySize

    pred_battery_tesla = []
    pred_battery_watthours = []
    entire_home = []
    entire_solar = []
    weekly_best_times = []
    actual_grid = []
    modeled_grid = []
    actual_battery = []

    battery_level_from_forecasted = []
    gridUsage = 0
    solarToGrid = 0


    for ind, name in enumerate(fileNames):
        #print(currentBatteryState)
        home, solar, powerwall, grid, battery_level = parse("data/month/"+name+".csv")

        #extracting data
        actual_grid = actual_grid + grid
        entire_home = entire_home + home
        entire_solar = entire_solar + solar
        actual_battery = actual_battery + battery_level
        energyFlow = computeEnergyFlow(solar, home)
        costGrid, costRenewableIntegration, excessSolar, excessBattery, utility, temp_battery= computePredictedBatteryChargeAndTotalCost(currentBatteryState1, energyFlow, 20, batterySize)
        utility = utility[:96]
        solarToGrid += sum([item*1000 for item in utility if item >= 0])
        gridUsage += sum([item*-1000 for item in utility if item <= 0])
        modeled_grid = modeled_grid + utility[:96]
        # print(excessSolar)
        currentBatteryState1 = temp_battery[95]*1000
        pred_battery_watthours = pred_battery_watthours + temp_battery[:96]
        temp_battery = [round(item / (batterySize/1000), 2)*100 for item in temp_battery] #convert to battery percentage
        temp_battery = temp_battery[:96]
        pred_battery_tesla = pred_battery_tesla + temp_battery
    print("Original grid usage: {}%, solar to grid: {}%".format(gridUsage*100/ sum(entire_home), solarToGrid*100/(sum(entire_solar))))

    val1, val2, u_, endingBatt = checkTime(originalBatteryState, batterySize, filtered_base*4, entire_solar, True, filtered_flex_nozeroes, 0, 88)

    # val1, val2, u_ = checkTime(originalBatteryState, batterySize, filtered_base[:672], entire_solar, False, filtered_flex_nozeroes, 0, 88)
    print("With flex load grid usage: {}%, solar to grid: {}%".format(val1, val2))

    avgImprovedGridUsage, avgImprovedRenewableIntegration = 0,0

    for ind, name in enumerate(fileNames):
        #print(currentBatteryState)

        home, solar, powerwall, grid, battery_level = parse("data/month/"+name+".csv")


        # algorithm testing 
        #user_model = UserProfile(weight1, weight2, weight3, lowerLimit, maximumLimit, shutOffRisk, idealReserveThreshold, solarForecast, baseForecast, currentBatteryState, batterySize)
        #baseForecast = filtered_base[ind*96:ind*96+192]
        baseForecast = historical_baseload_avg*2
        #solarForecast = pred_solar[ind*96:ind*96+192]
        solarForecast = entire_solar[ind*96:ind*96+192]

        user_model = UserProfile(weight1, weight2, weight3, lowerLimit, maximumLimit, shutOffRisk, idealReserveThreshold, solarForecast, baseForecast, currentBatteryState2, batterySize)

        # avg duration: 10.630434782608695 --> 11
        # avg charge: 10.854913043478252 --> 10854.91
        TeslaEV = FlexibleLoad("Tesla EV", 45791, 40) #example

        best_threshold, best_score, best_solar, best_battery, utility, battery = find_optimal_threshold(user_model)
        currentBatteryState2 = battery[95]*1000

        good_times, costCharge = find_good_times(user_model, best_threshold, TeslaEV)
        battery_level_from_forecasted = battery_level_from_forecasted + battery[:96]
        besttimes = convertRangeToTimes(findRange(good_times + [0]))
        weekly_best_times = weekly_best_times + good_times
        shouldCharge = should_charge(user_model, best_threshold, costCharge)
        print("Results for {}: Best threshold - {}, Should charge - {}, Best times - {}. ".format(name, best_threshold, shouldCharge, besttimes))

        val1, val2, u_, endingBatt = checkTime(originalBatteryState, batterySize, filtered_base*4, entire_solar, shouldCharge, filtered_flex_nozeroes, ind, findRange(good_times + [0])[0][0])
        # print(u_)
        avgImprovedGridUsage += val1
        avgImprovedRenewableIntegration += val2
        print("Estimated performance if charging today at {}: grid usage {}%, solar to grid: {}%, with ending battery {}".format(convertIndexToTime(findRange(good_times + [0])[0][0]), val1*100, val2*100, round(endingBatt / (batterySize/1000), 2)*100 ))

        print("--------------------------------------------------------------------------")

    #model
    print("DATA:")
    # print(pred_battery_tesla)
    # print(entire_solar)
    # print(entire_home)
    # print(actual_grid)
    # print(modeled_grid)
    # print(actual_battery)

    #testing results
    print("RESULTS:")
    print("Avg improved gridusage: {}, Avg improved renewable integration: {}".format(avgImprovedGridUsage/32, avgImprovedRenewableIntegration/32))
    # battery_level_from_forecasted = [round(item / (batterySize/1000), 2)*100 for item in battery_level_from_forecasted] #convert to battery percentage
    # print(battery_level_from_forecasted)
    # print(weekly_best_times)



    #diff = [real - pred for real, pred in zip(battery_level, pred_battery)]
    #r2 = r2_score(battery_level, pred_battery )
    #print(r2) #0.9759982805785794



    


